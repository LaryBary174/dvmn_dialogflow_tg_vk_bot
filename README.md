# TG и VK боты с интеграцией с Dialogflow
Dialogflow — это облачный сервис распознавания естественного языка от Google, который используется для создания чат-ботов.

Сервис распознаёт намерения пользователя на базе обучающих фраз и определяет, какой тип ответа предоставить на конкретные вопросы

## Установка ##

Python3 должен быть уже установлен. Затем используйте pip (или pip3, есть конфликт с Python2) для установки
зависимостей:

```
pip install -r requirements.txt
```

Интерпретатор 3.8 +

## Проект Dialogflow
Перед запуском программы необходимо создать проект на [Dialogflow](https://dialogflow.cloud.google.com/)

Далее переходите Apis&Services и создаете `create crendentials/service account`, указывая имя и роли

Создайте ключ от сервисного аккаунта, формат JSON , файл автоматически загрузится, он будет использоваться для аутентификации в Google Cloud

Обязательно необходимо включить апи(Enable API) в Apis&Services

## Заполнить Dialogflow(Создание Intents)
Данные для заполнения были взяты от [Devman](https://dvmn.org/media/filer_public/a7/db/a7db66c0-1259-4dac-9726-2d1fa9c44f20/questions.json), в формате json со списком вопросов и ответом на эти вопросы

Чтобы не заполнять это все вручную на [Dialogflow](https://dialogflow.cloud.google.com/) есть скрипт для заполнения с обязательным параметром url

В параметр `url` передается ссылка на вопросы ответы в json формате, пример данных:

```
{
    "Устройство на работу": {
        "questions": [
            "Как устроиться к вам на работу?",
            "Как устроиться к вам?",
            "Как работать у вас?",
            "Хочу работать у вас",
            "Возможно-ли устроиться к вам?",
            "Можно-ли мне поработать у вас?",
            "Хочу работать редактором у вас"
        ],
        "answer": "Если вы хотите устроиться к нам, напишите на почту game-of-verbs@gmail.com мини-эссе о себе и прикрепите ваше портфолио."
    },

```
Запуск скрипта:
```
py load_data_for_intent.py -u example.questions.json

```





## Создание сообщества в VK
Создаете сообщество

Перейти в Управление\Работа с API

Создать ключ API

Разрешить сообщение для сообщества


### Переменные окружения

Часть настроек проекта берётся из переменных окружения. Чтобы их определить, создайте файл `.env` в корне проекта и
запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

Доступны следующие переменные:

- `GOOGLE_APPLICATION_CREDENTIALS` — путь к файлу который сохранили получая ключ от сервисного аккаунта в формате json
- `GOOGLE_PROJECT_ID` - ID вашего проекта на [Dialogflow](https://dialogflow.cloud.google.com/)
- `TELEGRAM_BOT_TOKEN` — Токен для телеграмм бота получаете при создании телеграмм бота на канале в телеграм @BotFather
- `TG_LOG_TOKEN` - Токен для телеграмм бота с логами работы основного бота
- `TELEGRAM_CHAT_ID` — ID телеграмм чата, где планируете получать уведомления от бота с логами
- `VK_GROUP_API_KEY` - API KEY сообщества в VK


### Запуск ботов
![bot](https://github.com/user-attachments/assets/1a2151a4-591d-41a4-b8ee-67a695fd9d69)
Запуск VK бота
```
py vk_bot.py
```

Запуск TG бота
```
py telegram_bot.py
```
Пример работы [VK](https://vk.com/club229981207)

### Цель проекта 

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [Devman](https://dvmn.org).